{
    "resourceType": "clusterconfig",
    "collectionName": "clusterconfigs",

    "resourceFields": {
        "name": {
            "type": "string"
        },
        "option": {
            "type": "zkeConfigOption"
        },
        "nodes": {
            "type": "array",
            "elemType": "node"
        },
        "core": {
            "type": "zkeConfigCore"
        },
        "network": {
            "type": "zkeConfigNetwork"
        },
        "systemImage": {
            "type": "systemImage"
        },
        "privateRegistries": {
            "type": "array",
            "elemType": "privateRegistry"
        },
        "version": {
            "type": "string"
        }
    },

    "subResources": {
        "zkeConfigOption": {
            "sshUser": {
                "type": "string"
            },
            "sshPort": {
                "type": "string"
            },
            "sshKey": {
                "type": "string"
            },
            "dockerSocket": {
                "type": "string"
            },
            "kubernetesVersion": {
                "type": "string"
            },
            "ignoreDockerVersion": {
                "type": "bool"
            },
            "clusterCidr": {
                "type": "string"
            },
            "serviceClusterIpRange": {
                "type": "string"
            },
            "clusterDomain": {
                "type": "string"
            }
        },
        "node": {
            "name": {
                "type": "string"
            },
            "address": {
                "type": "string"
            },
            "internalAddress": {
                "type": "string"
            },
            "roles": {
                "type": "array",
                "elemType": "enum",
                "validValues": ["controlplane", "worker", "etcd", "storage", "edge"]
            },
            "hostnameOverride": {
                "type": "string"
            },
            "sshUser": {
                "type": "string"
            },
            "sshPort": {
                "type": "string"
            },
            "sshKey": {
                "type": "string"
            },
            "dockerSocket": {
                "type": "string"
            },
            "labels": {
                "type": "map",
                "keyType": "string",
                "valueType": "string"
            }
        },
        "zkeConfigCore": {
            "etcd": {
                "type": "etcd"
            },
            "kubeApi": {
                "type": "kubeApi"
            },
            "kubeController": {
                "type": "kubeController"
            },
            "scheduler": {
                "type": "scheduler"
            },
            "kubelet": {
                "type": "kubelet"
            },
            "kubeproxy": {
                "type": "kubeproxy"
            },
            "authentication": {
                "type": "authentication"
            },
            "authorization": {
                "type": "authorization"
            }
        },
        "etcd": {
            "image": {
                "type": "string"
            },
            "extraArgs": {
                "type": "map",
                "keyType": "string",
                "valueType": "string"
            },
            "extraBinds": {
                "type": "array",
                "elemType": "string"
            },
            "extraEnv": {
                "type": "array",
                "elemType": "string"
            },
            "externalUrls": {
                "type": "array",
                "elemType": "string"
            },
            "caCert": {
                "type": "string"
            },
            "cert": {
                "type": "string"
            },
            "key": {
                "type": "string"
            },
            "path": {
                "type": "string"
            },
            "snapshot": {
                "type": "bool"
            },
            "retention": {
                "type": "string"
            },
            "creation": {
                "type": "string"
            },
            "backupConfig": {
                "type": "backupConfig"
            }
        },
        "kubeApi": {
            "image": {
                "type": "string"
            },
            "extraArgs": {
                "type": "map",
                "keyType": "string",
                "valueType": "string"
            },
            "extraBinds": {
                "type": "array",
                "elemType": "string"
            },
            "extraEnv": {
                "type": "array",
                "elemType": "string"
            },
            "serviceClusterIpRange": {
                "type": "string"
            },
            "serviceNodePortRange": {
                "type": "string"
            },
            "podSecurityPolicy": {
                "type": "bool"
            },
            "alwaysPullImages": {
                "type": "bool"
            }
        },
        "kubeController": {
            "image": {
                "type": "string"
            },
            "extraArgs": {
                "type": "map",
                "keyType": "string",
                "valueType": "string"
            },
            "extraBinds": {
                "type": "array",
                "elemType": "string"
            },
            "extraEnv": {
                "type": "array",
                "elemType": "string"
            },
            "clusterCidr": {
                "type": "string"
            },
            "serviceClusterIpRange": {
                "type": "string"
            }
        },
        "scheduler": {
            "image": {
                "type": "string"
            },
            "extraArgs": {
                "type": "map",
                "keyType": "string",
                "valueType": "string"
            },
            "extraBinds": {
                "type": "array",
                "elemType": "string"
            },
            "extraEnv": {
                "type": "array",
                "elemType": "string"
            }
        },
        "kubelet": {
            "image": {
                "type": "string"
            },
            "extraArgs": {
                "type": "map",
                "keyType": "string",
                "valueType": "string"
            },
            "extraBinds": {
                "type": "array",
                "elemType": "string"
            },
            "extraEnv": {
                "type": "array",
                "elemType": "string"
            },
            "clusterDomain": {
                "type": "string"
            },
            "infraContainerImage": {
                "type": "string"
            },
            "clusterDnsServer": {
                "type": "string"
            },
            "failSwapOn": {
                "type": "bool"
            }
        },
        "kubeproxy": {
            "image": {
                "type": "string"
            },
            "extraArgs": {
                "type": "map",
                "keyType": "string",
                "valueType": "string"
            },
            "extraBinds": {
                "type": "array",
                "elemType": "string"
            },
            "extraEnv": {
                "type": "array",
                "elemType": "string"
            }
        },
        "authentication": {
            "strategy": {
                "type": "string"
            },
            "sans": {
                "type": "array",
                "elemType": "string"
            },
            "webhook": {
                "type": "authWebhookConfig"
            }
        },
        "authorization": {
            "mode": {
                "type": "string"
            },
            "options": {
                "type": "map",
                "keyType": "string",
                "valueType": "string"
            }
        },
        "authWebhookConfig": {
            "configFile": {
                "type": "string"
            },
            "cacheTimeout": {
                "type": "string"
            }
        },
        "backupConfig": {
            "intervalHours": {
                "type": "int"
            },
            "retention": {
                "type": "int"
            }
        },
        "zkeConfigNetwork": {
            "plugin": {
                "type": "enum",
                "validValues": ["flannel", "calico"]
            },
            "iface": {
                "type": "string"
            },
            "dns": {
                "type": "dns"
            },
            "ingress": {
                "type": "ingress"
            }
        },
        "dns": {
            "provider": {
                "type": "string"
            },
            "upstreamnameservers": {
                "type": "array",
                "elemType": "string"
            },
            "reversecidrs": {
                "type": "array",
                "elemType": "string"
            },
            "nodeSelector": {
                "type": "map",
                "keyType": "string",
                "valueType": "string"
            }
        },
        "ingress": {
            "provider": {
                "type": "string"
            },
            "options": {
                "type": "map",
                "keyType": "string",
                "valueType": "string"
            },
            "nodeSelector": {
                "type": "map",
                "keyType": "string",
                "valueType": "string"
            },
            "extraArgs": {
                "type": "map",
                "keyType": "string",
                "valueType": "string"
            }
        },
        "systemImage": {
            "etcd": {
                "type": "string"
            },
            "alpine": {
                "type": "string"
            },
            "nginxProxy": {
                "type": "string"
            },
            "certDownloader": {
                "type": "string"
            },
            "zkeRemover": {
                "type": "string"
            },
            "kubernetesServicesSidecar": {
                "type": "string"
            },
            "corednsc": {
                "type": "string"
            },
            "corednsAutoscaler": {
                "type": "string"
            },
            "kubernetes": {
                "type": "string"
            },
            "flannel": {
                "type": "string"
            },
            "flannelCni": {
                "type": "string"
            },
            "calicoNode": {
                "type": "string"
            },
            "calicoCni": {
                "type": "string"
            },
            "calicoControllers": {
                "type": "string"
            },
            "calicoCtl": {
                "type": "string"
            },
            "podInfraContainer": {
                "type": "string"
            },
            "ingress": {
                "type": "string"
            },
            "ingressBackend": {
                "type": "string"
            },
            "metricsServer": {
                "type": "string"
            },
            "clusterAgent": {
                "type": "string"
            },
            "nodeAgent": {
                "type": "string"
            }
        },
        "privateRegistry": {
            "url": {
                "type": "string"
            },
            "user": {
                "type": "string"
            },
            "password": {
                "type": "string"
            },
            "cacert": {
                "type": "string"
            }
        },
        "version": {
            "type": "string"
        }
    },

    "resourceMethods": ["GET", "PUT", "DELETE"],
    "collectionMethods": ["GET", "POST"],

    "postParameters": {
        "fields": {
            "name": {
                "type": "string",
                "required": true
            },
            "option": {
                "type": "zkeConfigOption",
                "required": true
            },
            "nodes": {
                "type": "array",
                "elemType": "node",
                "required": true
            },
            "network": {
                "type": "zkeConfigNetwork",
                "required": true
            },
            "privateRegistries": {
                "type": "array",
                "elemType": "privateRegistry"
            }
        },
        "subResources": {
            "zkeConfigOption": {
                "sshUser": {
                    "type": "string",
                    "required": true
                },
                "sshPort": {
                    "type": "string",
                    "required": true
                },
                "sshKey": {
                    "type": "string",
                    "required": true
                },
                "dockerSocket": {
                    "type": "string",
                    "required": true
                },

                "kubernetsVersion": {
                    "type": "string"
                },
                "ignoreDockerVersion": {
                    "type": "bool"
                },
                "clusterCidr": {
                    "type": "string",
                    "required": true
                },
                "serviceClusterIpRange": {
                    "type": "string",
                    "required": true
                },
                "clusterDomain": {
                    "type": "string",
                    "required": true
                }
            },
            "node": {
                "name": {
                    "type": "string",
                    "required": true
                },
                "address": {
                    "type": "string",
                    "required": true
                },
                "internalAddress": {
                    "type": "string"
                },
                "roles": {
                    "type": "array",
                    "elemType": "enum",
                    "validValues": ["controlplane", "worker", "etcd", "storage", "edge"],
                    "required": true
                },
                "hostnameOverride": {
                    "type": "string"
                },
                "sshUser": {
                    "type": "string"
                },
                "sshPort": {
                    "type": "string"
                },
                "sshKey": {
                    "type": "string"
                },
                "dockerSocket": {
                    "type": "string"
                },
                "labels": {
                    "type": "map",
                    "keyType": "string",
                    "valueType": "string"
                }
            },
            "zkeConfigNetwork": {
                "plugin": {
                    "type": "enum",
                    "validValues": ["flannel", "calico"],
                    "required": true
                },
                "iface": {
                    "type": "string",
                    "required": true
                },
                "dns": {
                    "type": "dns"
                },
                "ingress": {
                    "type": "ingress"
                }
            },
            "dns": {
                "provider": {
                    "type": "string"
                },
                "upstreamnameservers": {
                    "type": "array",
                    "elemType": "string"
                },
                "reversecidrs": {
                    "type": "array",
                    "elemType": "string"
                },
                "nodeSelector": {
                    "type": "map",
                    "keyType": "string",
                    "valueType": "string"
                }
            },
            "ingress": {
                "provider": {
                    "type": "string"
                },
                "options": {
                    "type": "map",
                    "keyType": "string",
                    "valueType": "string"
                },
                "nodeSelector": {
                    "type": "map",
                    "keyType": "string",
                    "valueType": "string"
                },
                "extraArgs": {
                    "type": "map",
                    "keyType": "string",
                    "valueType": "string"
                }
            },
            "privateRegistry": {
                "url": {
                    "type": "string"
                },
                "user": {
                    "type": "string"
                },
                "password": {
                    "type": "string"
                },
                "cacert": {
                    "type": "string"
                }
            }
        }
    }
}